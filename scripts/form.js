var k="https://e41abda2826294b6.mokky.dev/formdata";function T(){document.querySelector("#modal-success").classList.add("is-active")}function b(){document.querySelector("#modal-error").classList.add("is-active")}function x(){let o=document.querySelector("form");if(!o)return;let s=o.querySelector('input[name="username"]'),t=o.querySelector('input[name="tel"]'),n=o.querySelector('input[name="comment"]'),i=o.querySelector('input[name="agreement"]'),f=o.querySelector('button[type="submit"]'),h=o.querySelectorAll(".error");h.forEach(e=>{e.style.display="none"});let d=!1,m=!1,p=!1,v=!1;$(t);function y(){let e=s.value.trim(),r=s.parentElement.querySelector(".error");return e?e.length<2?(d&&u(r,"\u0418\u043C\u044F \u0434\u043E\u043B\u0436\u043D\u043E \u0441\u043E\u0434\u0435\u0440\u0436\u0430\u0442\u044C \u043C\u0438\u043D\u0438\u043C\u0443\u043C 2 \u0441\u0438\u043C\u0432\u043E\u043B\u0430"),!1):(l(r),!0):(d&&u(r,"\u0418\u043C\u044F \u043E\u0431\u044F\u0437\u0430\u0442\u0435\u043B\u044C\u043D\u043E \u0434\u043B\u044F \u0437\u0430\u043F\u043E\u043B\u043D\u0435\u043D\u0438\u044F"),!1)}function g(){let e=t.value.trim(),r=t.parentElement.querySelector(".error"),c=/^\+7\s\(\d{3}\)\s\d{3}-\d{2}-\d{2}$/;return e?c.test(e)?(l(r),!0):(m&&u(r,"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0442\u0435\u043B\u0435\u0444\u043E\u043D \u0432 \u0444\u043E\u0440\u043C\u0430\u0442\u0435 +7 (999) 999-99-99"),!1):(m&&u(r,"\u0422\u0435\u043B\u0435\u0444\u043E\u043D \u043E\u0431\u044F\u0437\u0430\u0442\u0435\u043B\u0435\u043D \u0434\u043B\u044F \u0437\u0430\u043F\u043E\u043B\u043D\u0435\u043D\u0438\u044F"),!1)}function S(){let e=n.value.trim(),r=n.parentElement.querySelector(".error");return e?(l(r),!0):(p&&u(r,"\u041F\u043E\u043B\u0435 \u043E\u0431\u044F\u0437\u0430\u0442\u0435\u043B\u044C\u043D\u043E \u0434\u043B\u044F \u0437\u0430\u043F\u043E\u043B\u043D\u0435\u043D\u0438\u044F"),!1)}function q(){let e=i.parentElement.querySelector(".error");return i.checked?(l(e),!0):(v&&u(e,"\u041D\u0435\u043E\u0431\u0445\u043E\u0434\u0438\u043C\u043E \u043F\u0440\u0438\u043D\u044F\u0442\u044C \u0443\u0441\u043B\u043E\u0432\u0438\u044F \u0441\u043E\u0433\u043B\u0430\u0448\u0435\u043D\u0438\u044F"),!1)}function L(){let e=y(),r=g(),c=S(),E=q();return e&&r&&c&&E}function a(){f.disabled=!L()}function u(e,r){e&&(e.textContent=r,e.style.display="inline")}function l(e){e&&(e.style.display="none")}s.addEventListener("focus",()=>{d=!0}),t.addEventListener("focus",()=>{m=!0}),n.addEventListener("focus",()=>{p=!0}),i.addEventListener("focus",()=>{v=!0}),s.addEventListener("input",()=>{let e=s.value.trim(),r=s.parentElement.querySelector(".error");e&&e.length>=2&&l(r),a()}),t.addEventListener("input",()=>{let e=t.value.trim(),r=t.parentElement.querySelector(".error");e&&/^\+7\s\(\d{3}\)\s\d{3}-\d{2}-\d{2}$/.test(e)&&l(r),a()}),n.addEventListener("input",()=>{let e=n.value.trim(),r=n.parentElement.querySelector(".error");e&&l(r),a()}),s.addEventListener("blur",()=>{d=!0,y(),a()}),t.addEventListener("blur",()=>{m=!0,g(),a()}),n.addEventListener("blur",()=>{p=!0,S(),a()}),i.addEventListener("change",()=>{v=!0;let e=i.parentElement.querySelector(".error");i.checked?l(e):u(e,"\u041D\u0435\u043E\u0431\u0445\u043E\u0434\u0438\u043C\u043E \u043F\u0440\u0438\u043D\u044F\u0442\u044C \u0443\u0441\u043B\u043E\u0432\u0438\u044F \u0441\u043E\u0433\u043B\u0430\u0448\u0435\u043D\u0438\u044F"),a()}),o.addEventListener("submit",async e=>{if(e.preventDefault(),d=!0,m=!0,p=!0,v=!0,!L()){a();return}let r={username:s.value.trim(),tel:t.value.trim(),comment:n.value.trim(),agreement:i.checked};f.classList.add("loading"),f.innerHTML="<span>\u041E\u0442\u043F\u0440\u0430\u0432\u043A\u0430...</span>";try{(await fetch(k,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)})).ok?(o.reset(),d=!1,m=!1,p=!1,v=!1,h.forEach(E=>{E.style.display="none"}),T()):b()}catch(c){console.error("\u041E\u0448\u0438\u0431\u043A\u0430:",c),b()}finally{f.innerHTML="<span>\u043E\u0442\u043F\u0440\u0430\u0432\u0438\u0442\u044C</span>",f.classList.remove("loading"),a()}}),a()}function $(o){o&&o.addEventListener("input",s=>{let t=s.target.value.replace(/\D/g,"");t.length>0&&!["7","8"].includes(t[0])&&(t=`7${t}`);let n="+7";t.length>1&&(n+=` (${t.substring(1,4)}`),t.length>=4&&(n+=`) ${t.substring(4,7)}`),t.length>=7&&(n+=`-${t.substring(7,9)}`),t.length>=9&&(n+=`-${t.substring(9,11)}`),s.target.value=n})}export{x as initFormValidation};
